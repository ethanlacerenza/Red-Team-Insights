# How Vulnerability Scanners Work
## Vulnerability Scanning
*Date: March 18, 2024*

A vulnerability scanner operates through the following stages:
1. **Host Discovery**: Identifies if the target is up and responding.
2. **Port Scanning**: Detects open ports and services, including their versions.
3. **Operating System and Service Detection**: Gathers details about the operating system, services, and their versions.
4. **Vulnerability Database Query**: Matches the gathered information against a vulnerability database. Common databases include NVD (National Vulnerability Database) and CVE (Common Vulnerabilities and Exposures).

## Types of Vulnerability Scans
*Date: March 18, 2024*

### CVE and CVSS
- **CVE (Common Vulnerabilities and Exposures)**: Provides unique identifiers for vulnerabilities.
- **CVSS (Common Vulnerability Scoring System)**: A framework for assessing the characteristics and severity of vulnerabilities. 
  - **CVSS2 and CVSS3**: Two major versions, scoring from 0 to 10.
  - **NIST (National Institute of Standards and Technology)**: Maintains CVSS metrics.

### Common Issues
- **False Positives**: Issues such as backported software (where security fixes are applied).
- **False Negatives**: Missed vulnerabilities.

## Things to Consider in a Vulnerability Scan
*Date: March 18, 2024*

### Types of Vulnerability Scans
- **External**: Scans for DMZ and exposed services.
- **Internal**: Scans within the internal network.
- **Authenticated**: Provides credentials to detect vulnerabilities and misconfigurations with greater visibility.
- **Unauthenticated**: Scans the external perimeter.

### Additional Considerations
- **Scanning Duration**: Can vary greatly depending on the scan.
- **Target Visibility**: Important to consider if the target is accessible without VPN/firewall rules.
- **Intermediate Hosts**: Hops can alter traffic.

## Nessus Components
*Date: March 19, 2024*

### Scan Configuration
- **Scans and Settings**: Configure the application through the "Scans" tab.
  - **Policies**: Define scanning policies.
  - **Scanning Templates**: Include discovery, vulnerabilities, and compliance.

### Scanning Templates
- **Basic Network Scans**: Performs a full scan with most settings predefined, detecting a broad range of vulnerabilities.
- **Advanced Scan**: Provides a template without predefined settings, allowing for more customized scans.

## Performing an Authenticated Vulnerability Scan
*Date: May 10, 2024*

### Authenticated Scans
- **Purpose**: Provides credentials for more detailed information and reduces false positives. May generate more noise and notifications from EDR (Endpoint Detection and Response).
- **Credentials**: All Nessus templates accept credentials. Use the credentials patch audit for authentication.
  - **Linux and macOS**: Uses SSH.
  - **Windows**: Uses SMB (Server Message Block) or WMI (Windows Management Instrumentation).
- **Potential Issues**: Security systems on the target machine can block the scan. UAC (User Account Control) may interfere with the scan.

